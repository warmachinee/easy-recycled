(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{123:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(1),o=a(0),s=a.n(o),i=a(59);function l(e,t){var a=s.a.memo(s.a.forwardRef((function(t,a){return s.a.createElement(i.a,Object(n.a)({ref:a},t),e)})));return a.muiName=i.a.muiName,a}},139:function(e,t,a){"use strict";var n=a(1),o=a(2),s=a(0),i=a.n(s),l=(a(3),a(7)),r=a(10),c=a(18),d=a(639),u=a(25),m=i.a.forwardRef((function(e,t){var a=e.edge,s=void 0!==a&&a,r=e.children,c=e.classes,m=e.className,p=e.color,b=void 0===p?"default":p,f=e.disabled,g=void 0!==f&&f,y=e.disableFocusRipple,h=void 0!==y&&y,v=e.size,O=void 0===v?"medium":v,j=Object(o.a)(e,["edge","children","classes","className","color","disabled","disableFocusRipple","size"]);return i.a.createElement(d.a,Object(n.a)({className:Object(l.a)(c.root,m,"default"!==b&&c["color".concat(Object(u.a)(b))],g&&c.disabled,"small"===O&&c["size".concat(Object(u.a)(O))],{start:c.edgeStart,end:c.edgeEnd}[s]),centerRipple:!0,focusRipple:!h,disabled:g,ref:t},j),i.a.createElement("span",{className:c.label},r))}));t.a=Object(r.a)((function(e){return{root:{textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:12,borderRadius:"50%",overflow:"visible",color:e.palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{backgroundColor:Object(c.d)(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{backgroundColor:"transparent",color:e.palette.action.disabled}},edgeStart:{marginLeft:-12,"$sizeSmall&":{marginLeft:-3}},edgeEnd:{marginRight:-12,"$sizeSmall&":{marginRight:-3}},colorInherit:{color:"inherit"},colorPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(c.d)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},colorSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(c.d)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},disabled:{},sizeSmall:{padding:3,fontSize:e.typography.pxToRem(18)},label:{width:"100%",display:"flex",alignItems:"inherit",justifyContent:"inherit"}}}),{name:"MuiIconButton"})(m)},177:function(e,t,a){"use strict";var n=a(0),o=a.n(n),s=a(123);t.a=Object(s.a)(o.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},224:function(e,t){},624:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(184),i=a.n(s),l=a(104),r=a(28),c=a(26),d=a.n(c),u=a(139),m=a(177),p=a(22);const b=Object(l.a)(e=>({})),f=window.liff,g=d()({loader:()=>Promise.all([a.e(0),a.e(2),a.e(76),a.e(42)]).then(a.bind(null,568)),loading:()=>null}),y=d()({loader:()=>Promise.all([a.e(0),a.e(37)]).then(a.bind(null,134)),loading:()=>null}),h=d()({loader:()=>Promise.all([a.e(0),a.e(2),a.e(3),a.e(4),a.e(46)]).then(a.bind(null,300)),loading:()=>null}),v=(d()({loader:()=>a.e(23).then(a.bind(null,569)),loading:()=>null}),d()({loader:()=>Promise.all([a.e(0),a.e(2),a.e(3),a.e(4),a.e(21)]).then(a.bind(null,570)),loading:()=>null})),O=d()({loader:()=>Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(41)]).then(a.bind(null,571)),loading:()=>null}),j=({location:e,history:t,match:a})=>{b();const{csrf:s,setCsrf:l,setDense:c,enQSnackbar:d,closeSnackbar:p,_xhrPost:j,_xhrGet:k,_onLocalhost:w,_onLocalhostFn:S,booleanReducer:E,_isDesktopBrowser:x}=Object(n.useContext)(r.a),[C,I]=Object(n.useState)(null),[R,N]=Object(n.useState)(null),[P,z]=Object(n.useState)(null),[L,D]=Object(n.useState)(null),[_,F]=Object(n.useState)(null),[$,U]=o.a.useState(0),[{noti:A},B]=Object(n.useReducer)(E,{noti:!1}),J={...Object(n.useContext)(r.a),sess:R,getSess:G,profileData:C,addSnackbar:function({message:e,variant:t}){d({message:e,variant:t,action:H})},handleLogout:async function(){const e=await k("logout");l(e.csrf),f.isLoggedIn()&&f.logout();window.location.reload()},checkSession:Q,notifications:_,setNotifications:F,notiPage:$,setNotiPage:U,readNotifications:async function(){const e=await j({csrf:s,url:"usersystem",body:{action:"readnoti",linetoken:C&&C.userId,type:"business"}});l(e.csrf),q(C)},userInfo:P,getInfo:T,booleanDispatch:B,realtimeAccess:function(){i()("https://easyrecycle.ml",{transports:["websocket","polling"]}).emit("noti",{action:"noti",linetoken:C&&C.userId,type:"business",startindex:0,lastindex:10*($+1)})},realtimeEndOfSale:function(e){const t=i()("https://easyrecycle.ml",{transports:["websocket","polling"]}),{linetoken:a}=e;t.emit("noti",{action:"noti",linetoken:a,type:"customer",startindex:0,lastindex:10*($+1)})}};function M(){f.init({liffId:"1653861118-82Pmap5k"},async()=>{f.isLoggedIn()?f.getProfile().then(e=>{I(e),G(e)}).catch(e=>console.error(e)):f.login()})}async function T(e){const t=await j({csrf:s,url:"loadusersystem",body:{action:"info",type:"business"}});if(l(t.csrf),"status"in t.data)Q();else{const a=t.data,n=a;n.displayname!==e.displayName||n.picture!==e.pictureUrl?async function(e,t){const a={action:"editprofile",linetoken:t.userId,type:"business"};e.displayname!==t.displayName&&Object.assign(a,{displayname:t.displayName});e.picture!==t.pictureUrl&&Object.assign(a,{picture:t.pictureUrl});const n=await j({csrf:s,url:"usersystem",body:a});l(n.csrf),M()}(n,e):z(a)}}async function G(e){N(null),D(null);const t=await j({csrf:s,url:"session",body:{linetoken:e.userId,type:"business"}});l(t.csrf),N(t.data),D(t.data),"not member"!==t.data.status&&(T(e),q(e))}async function Q(){const e=await k("logout");l(e.csrf),window.location.reload()}async function q(e){const t=await j({csrf:s,url:"loadusersystem",body:{action:"noti",linetoken:e.userId,type:"business",startindex:0,lastindex:10*($+1)}});l(t.csrf),"status"in t.data&&"this is not user account or have been delete account"===t.data.status?Q():F(t.data)}Object(n.useEffect)(()=>{var e;C&&R&&(e=R,i()("https://easyrecycle.ml",{transports:["websocket","polling"]}).on(`noti-${e.userid}`,e=>{if(e&&"success"===e.status){const{list:t}=e.result;F(t)}}),q(C))},[R,C,$]),Object(n.useEffect)(()=>{M(),c(!0)},[]);const H=e=>o.a.createElement(u.a,{onClick:()=>p(e)},o.a.createElement(m.a,{style:{color:"white"}}));return o.a.createElement(r.a.Provider,{value:J},o.a.createElement("div",null,R&&("not member"!==R.status?o.a.createElement(o.a.Fragment,null,o.a.createElement(g,null),o.a.createElement(O,null)):o.a.createElement(v,Object.assign({},{profileData:C}))),o.a.createElement(y,{open:A,onClose:()=>B({type:"false",key:"noti"}),title:"การแจ้งเตือน",fullScreen:!0,dividers:!1,contentStyle:{padding:0}},o.a.createElement(h,{type:"business"}))))};t.default=Object(p.f)(e=>o.a.createElement(j,Object.assign({},e)))}}]);