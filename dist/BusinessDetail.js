(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["BusinessDetail"],{

/***/ "./src/page/Admin/Business/BusinessDetail.tsx":
/*!****************************************************!*\
  !*** ./src/page/Admin/Business/BusinessDetail.tsx ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_loadable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-loadable */ \"./node_modules/react-loadable/lib/index.js\");\n/* harmony import */ var react_loadable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_loadable__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _material_ui_styles__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @material-ui/styles */ \"./node_modules/@material-ui/styles/esm/index.js\");\n/* harmony import */ var _AppContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../AppContext */ \"./src/AppContext.tsx\");\n/* harmony import */ var _material_ui_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @material-ui/core */ \"./node_modules/@material-ui/core/esm/index.js\");\n/* harmony import */ var _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @material-ui/core/colors */ \"./node_modules/@material-ui/core/esm/colors/index.js\");\n/* harmony import */ var _material_ui_icons__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @material-ui/icons */ \"./node_modules/@material-ui/icons/esm/index.js\");\n/* harmony import */ var react_text_mask__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-text-mask */ \"./node_modules/react-text-mask/dist/reactTextMask.js\");\n/* harmony import */ var react_text_mask__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(react_text_mask__WEBPACK_IMPORTED_MODULE_7__);\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst GeneralDialog = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => Promise.all(/*! import() | GeneralDialog */[__webpack_require__.e(\"vendors~AddFab~AdminHeader~AdminList~BusinessList~BusinessProfile~BusinessType~Condition~ConfirmDial~e27619d6\"), __webpack_require__.e(\"GeneralDialog\")]).then(__webpack_require__.bind(null, /*! ../../../component/Dialog/GeneralDialog */ \"./src/component/Dialog/GeneralDialog.tsx\")),\r\n    loading: () => null\r\n});\r\nconst AppButton = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => __webpack_require__.e(/*! import() | AppButton */ \"AppButton\").then(__webpack_require__.bind(null, /*! ../../../AppComponent/AppButton */ \"./src/AppComponent/AppButton.tsx\")),\r\n    loading: () => null\r\n});\r\nconst GoodsList = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => Promise.all(/*! import() | GoodsList */[__webpack_require__.e(\"vendors~AddFab~AdminHeader~AdminList~BusinessList~BusinessProfile~BusinessType~Condition~ConfirmDial~e27619d6\"), __webpack_require__.e(\"vendors~BusinessList~CustomerList~GoodsList~Topup\"), __webpack_require__.e(\"GoodsList\")]).then(__webpack_require__.bind(null, /*! ./Goods/GoodsList */ \"./src/page/Admin/Business/Goods/GoodsList.tsx\")),\r\n    loading: () => null\r\n});\r\nconst useStyles = Object(_material_ui_styles__WEBPACK_IMPORTED_MODULE_2__[\"makeStyles\"])((theme) => ({\r\n    paper: { padding: 8 },\r\n    itemGrid: {\r\n        margin: theme.spacing(1, 0),\r\n        minWidth: 800,\r\n        padding: 12\r\n    },\r\n    itemPaper: {\r\n        position: \"relative\",\r\n        padding: 16,\r\n        display: \"flex\",\r\n        alignItems: \"center\"\r\n    },\r\n    avatar: { width: 72, height: 72, marginRight: 16 },\r\n    textField: { marginBottom: 12 }\r\n}));\r\nfunction TextMaskCustom(props) {\r\n    const { inputRef, ...other } = props;\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_text_mask__WEBPACK_IMPORTED_MODULE_7___default.a, Object.assign({}, other, { ref: (ref) => {\r\n            inputRef(ref ? ref.inputElement : null);\r\n        }, mask: [\r\n            \"(\",\r\n            /[0-9]/,\r\n            /\\d/,\r\n            /\\d/,\r\n            \")\",\r\n            \" \",\r\n            /\\d/,\r\n            /\\d/,\r\n            /\\d/,\r\n            \"-\",\r\n            /\\d/,\r\n            /\\d/,\r\n            /\\d/,\r\n            /\\d/\r\n        ], placeholderChar: \"\\u2000\" })));\r\n}\r\nconst DetailCard = props => {\r\n    const classes = useStyles();\r\n    const { _dateToString, stringToPhone } = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_AppContext__WEBPACK_IMPORTED_MODULE_3__[\"AppContext\"]);\r\n    const { data, setEditing } = props;\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Paper\"], { className: classes.itemPaper, elevation: data.status === 1 ? 3 : 0, style: {\r\n            ...(data.status === 0 && {\r\n                backgroundColor: \"inherit\",\r\n                opacity: 0.7\r\n            })\r\n        } },\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"IconButton\"], { style: { position: \"absolute\", top: 0, right: 0 }, onClick: () => setEditing(true) },\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_icons__WEBPACK_IMPORTED_MODULE_6__[\"Settings\"], null)),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Avatar\"], { className: classes.avatar, src: data.picture }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { style: { flex: 1, display: \"flex\", flexDirection: \"column\" } },\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { style: { flex: 1, fontWeight: 600 }, align: \"left\" },\r\n                data.status === 1 ? \"\" : \"(ไม่ได้ใช้งานแล้ว)\",\r\n                `${data.fullname} ${data.lastname} ( ${data.displayname} )`),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\", color: \"textSecondary\" }, data.statusmassage),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { style: { display: \"flex\" } },\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\", variant: \"body2\", color: \"textSecondary\", style: { marginRight: 16 } }, \"\\u0E2A\\u0E21\\u0E31\\u0E04\\u0E23\\u0E40\\u0E21\\u0E37\\u0E48\\u0E2D\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\"),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\", variant: \"body2\", style: { fontWeight: 700 } }, _dateToString(data.registerdate))),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { style: { display: \"flex\" } },\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\", variant: \"body2\", color: \"textSecondary\", style: { marginRight: 16 } }, \"\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23\\u0E28\\u0E31\\u0E1E\\u0E17\\u0E4C\"),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\", variant: \"body2\", style: { fontWeight: 700, marginRight: 24 } }, stringToPhone(`0${data.tel}`)),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\", variant: \"body2\", color: \"textSecondary\", style: { marginRight: 16 } }, \"\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25\"),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\", variant: \"body2\", style: { fontWeight: 700 } }, data.email))),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { align: \"left\" }, \"\\u0E08\\u0E33\\u0E19\\u0E27\\u0E19\\u0E2A\\u0E34\\u0E19\\u0E04\\u0E49\\u0E32\"),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { variant: \"h6\", style: {\r\n                width: 48,\r\n                marginRight: 16,\r\n                ...(data.frequencyform > 3 && { color: _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_5__[\"red\"][600], fontWeight: 700 })\r\n            }, align: \"right\" }, data.frequencyform)));\r\n};\r\nconst EditDetail = props => {\r\n    const classes = useStyles();\r\n    const { csrf, setCsrf, _xhrPost, _dateToString, stringToPhone, phoneFormatToNumber } = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_AppContext__WEBPACK_IMPORTED_MODULE_3__[\"AppContext\"]);\r\n    const { data, setEditing, getBaseDetail, match } = props;\r\n    const [thisData, setThisData] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])({\r\n        ...data,\r\n        tel: stringToPhone(`0${data.tel}`)\r\n    });\r\n    function checkDisabled() {\r\n        const keyArr = [\r\n            \"displayname\",\r\n            \"fullname\",\r\n            \"lastname\",\r\n            \"email\",\r\n            \"statusmassage\"\r\n        ];\r\n        const thisArr = [];\r\n        for (var i = 0; i < keyArr.length; i++) {\r\n            if (thisData[keyArr[i]] !== data[keyArr[i]]) {\r\n                thisArr.push(thisData[keyArr[i]]);\r\n            }\r\n        }\r\n        if (phoneFormatToNumber(thisData.tel) !== `0${data.tel}`) {\r\n            thisArr.push(thisData[keyArr[i]]);\r\n        }\r\n        return thisArr.length === 0;\r\n    }\r\n    async function onSave() {\r\n        const { params } = match;\r\n        const sendObj = {\r\n            action: \"base_edit\",\r\n            businessid: parseInt(params.businessid)\r\n        };\r\n        const keyArr = [\r\n            \"displayname\",\r\n            \"fullname\",\r\n            \"lastname\",\r\n            \"email\",\r\n            \"statusmassage\"\r\n        ];\r\n        for (var i = 0; i < keyArr.length; i++) {\r\n            if (thisData[keyArr[i]] !== data[keyArr[i]]) {\r\n                Object.assign(sendObj, { [keyArr[i]]: thisData[keyArr[i]] });\r\n            }\r\n        }\r\n        if (thisData.tel !== `0${data.tel}`) {\r\n            Object.assign(sendObj, { tel: phoneFormatToNumber(thisData.tel) });\r\n        }\r\n        const res = await _xhrPost({\r\n            csrf,\r\n            url: \"abusinesssystem\",\r\n            body: sendObj\r\n        });\r\n        setCsrf(res.csrf);\r\n        getBaseDetail();\r\n        setEditing(false);\r\n    }\r\n    async function onSaveStatus(status) {\r\n        const { params } = match;\r\n        const sendObj = {\r\n            action: \"base_edit\",\r\n            businessid: parseInt(params.businessid),\r\n            status\r\n        };\r\n        const res = await _xhrPost({\r\n            csrf,\r\n            url: \"abusinesssystem\",\r\n            body: sendObj\r\n        });\r\n        setCsrf(res.csrf);\r\n        getBaseDetail();\r\n        setEditing(false);\r\n    }\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", null,\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { style: { display: \"flex\", marginBottom: 12, alignItems: \"baseline\" } },\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { style: { width: 100 } }, \"\\u0E2A\\u0E16\\u0E32\\u0E19\\u0E30\\u0E1A\\u0E31\\u0E0D\\u0E0A\\u0E35\"),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { style: { display: \"flex\" } },\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Chip\"], Object.assign({ label: \"\\u0E40\\u0E1B\\u0E34\\u0E14\\u0E01\\u0E32\\u0E23\\u0E43\\u0E0A\\u0E49\\u0E07\\u0E32\\u0E19\", style: {\r\n                        marginRight: 4,\r\n                        ...(data.status === 1 && { color: \"white\" })\r\n                    } }, (data.status === 0 && { variant: \"outlined\" }), (data.status === 1 && { color: \"primary\" }), { onClick: () => onSaveStatus(1) })),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Chip\"], Object.assign({ label: \"\\u0E1B\\u0E34\\u0E14\\u0E01\\u0E32\\u0E23\\u0E43\\u0E0A\\u0E49\\u0E07\\u0E32\\u0E19\", style: { ...(data.status === 0 && { color: \"white\" }) } }, (data.status === 1 && { variant: \"outlined\" }), (data.status === 0 && { color: \"primary\" }), { onClick: () => onSaveStatus(0) })))),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Divider\"], { style: { margin: \"16px 0\" } }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"TextField\"], { className: classes.textField, fullWidth: true, label: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E17\\u0E35\\u0E48\\u0E41\\u0E2A\\u0E14\\u0E07\", value: thisData.displayname, onChange: e => setThisData({ ...thisData, displayname: e.target.value }) }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"TextField\"], { className: classes.textField, fullWidth: true, label: \"\\u0E0A\\u0E37\\u0E48\\u0E2D\", value: thisData.fullname, onChange: e => setThisData({ ...thisData, fullname: e.target.value }) }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"TextField\"], { className: classes.textField, fullWidth: true, label: \"\\u0E19\\u0E32\\u0E21\\u0E2A\\u0E01\\u0E38\\u0E25\", value: thisData.lastname, onChange: e => setThisData({ ...thisData, lastname: e.target.value }) }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"TextField\"], { className: classes.textField, fullWidth: true, label: \"\\u0E2A\\u0E40\\u0E15\\u0E15\\u0E31\\u0E2A\", value: thisData.statusmassage, onChange: e => setThisData({ ...thisData, statusmassage: e.target.value }) }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Divider\"], { style: { margin: \"16px 0\" } }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"TextField\"], { className: classes.textField, fullWidth: true, label: \"\\u0E40\\u0E1A\\u0E2D\\u0E23\\u0E4C\\u0E42\\u0E17\\u0E23\\u0E28\\u0E31\\u0E1E\\u0E17\\u0E4C\", InputProps: {\r\n                inputComponent: TextMaskCustom\r\n            }, value: thisData.tel, onChange: e => setThisData({ ...thisData, tel: e.target.value }) }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"TextField\"], { className: classes.textField, fullWidth: true, label: \"\\u0E2D\\u0E35\\u0E40\\u0E21\\u0E25\", value: thisData.email, onChange: e => setThisData({ ...thisData, email: e.target.value }) }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Divider\"], { style: { margin: \"12px 0\" } }),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { style: { display: \"flex\" } },\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(AppButton, { buttonColor: _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_5__[\"green\"], variant: \"outlined\", style: { flex: 1, margin: 8 }, onClick: () => {\r\n                    setThisData({\r\n                        ...data,\r\n                        tel: `0${data.tel}`\r\n                    });\r\n                    setEditing(false);\r\n                } }, \"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(AppButton, { buttonColor: _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_5__[\"green\"], variant: \"contained\", style: { flex: 1, margin: 8 }, onClick: onSave, disabled: checkDisabled() }, \"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"))));\r\n};\r\nconst BusinessDetail = props => {\r\n    const classes = useStyles();\r\n    const { match, history } = props;\r\n    const { csrf, setCsrf, _xhrPost, _onLocalhostFn } = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_AppContext__WEBPACK_IMPORTED_MODULE_3__[\"AppContext\"]);\r\n    const [detail, setDetail] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(null);\r\n    const [goods, setGoods] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(null);\r\n    const [editing, setEditing] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(false);\r\n    async function getBaseDetail() {\r\n        const { params } = match;\r\n        const res = await _xhrPost({\r\n            csrf,\r\n            url: \"aloadbusiness\",\r\n            body: {\r\n                action: \"base_detail\",\r\n                businessid: parseInt(params.businessid)\r\n            }\r\n        });\r\n        setCsrf(res.csrf);\r\n        setDetail(res.data);\r\n    }\r\n    Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(() => {\r\n        getBaseDetail();\r\n    }, []);\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", null,\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"IconButton\"], { onClick: () => history.replace(\"/admin/business_list\") },\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_icons__WEBPACK_IMPORTED_MODULE_6__[\"ArrowBackIos\"], null)),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { className: classes.itemGrid }, detail && react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(DetailCard, Object.assign({ data: detail }, { setEditing }))),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(GoodsList, null),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(GeneralDialog, { open: editing, onClose: () => setEditing(false), title: \"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\" }, detail && (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(EditDetail, Object.assign({ data: detail }, { setEditing, getBaseDetail, match }))))));\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (BusinessDetail);\r\n\n\n//# sourceURL=webpack:///./src/page/Admin/Business/BusinessDetail.tsx?");

/***/ })

}]);