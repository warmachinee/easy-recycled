(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["Dashboard"],{

/***/ "./src/page/Admin/Dashboard.tsx":
/*!**************************************!*\
  !*** ./src/page/Admin/Dashboard.tsx ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_loadable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-loadable */ \"./node_modules/react-loadable/lib/index.js\");\n/* harmony import */ var react_loadable__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_loadable__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _nivo_pie__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @nivo/pie */ \"./node_modules/@nivo/pie/dist/nivo-pie.esm.js\");\n/* harmony import */ var _material_ui_styles__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @material-ui/styles */ \"./node_modules/@material-ui/styles/esm/index.js\");\n/* harmony import */ var _material_ui_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @material-ui/core */ \"./node_modules/@material-ui/core/esm/index.js\");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/react-router-dom/esm/react-router-dom.js\");\n/* harmony import */ var _AppContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../AppContext */ \"./src/AppContext.tsx\");\n/* harmony import */ var _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @material-ui/core/colors */ \"./node_modules/@material-ui/core/esm/colors/index.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst AdminHeader = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => Promise.all(/*! import() | AdminHeader */[__webpack_require__.e(\"vendors~AddFab~AdminHeader~BusinessProfile~BusinessType~Condition~ConfirmDialog~Document~GeneralDial~983732dd\"), __webpack_require__.e(\"AdminHeader\")]).then(__webpack_require__.bind(null, /*! ./AdminHeader */ \"./src/page/Admin/AdminHeader.tsx\")),\r\n    loading: () => null\r\n});\r\nconst AdminSideNav = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => __webpack_require__.e(/*! import() | AdminSideNav */ \"AdminSideNav\").then(__webpack_require__.bind(null, /*! ./AdminSideNav */ \"./src/page/Admin/AdminSideNav.tsx\")),\r\n    loading: () => null\r\n});\r\nconst Topup = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => Promise.all(/*! import() | Topup */[__webpack_require__.e(\"vendors~BusinessList~BusinessNotifications~CustomerList~CustomerNotifications~GoodsList~Topup\"), __webpack_require__.e(\"Topup\")]).then(__webpack_require__.bind(null, /*! ./Other/Topup */ \"./src/page/Admin/Other/Topup.tsx\")),\r\n    loading: () => null\r\n});\r\nconst GoodsList = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => Promise.all(/*! import() | GoodsList */[__webpack_require__.e(\"vendors~AddFab~AdminHeader~BusinessProfile~BusinessType~Condition~ConfirmDialog~Document~GeneralDial~983732dd\"), __webpack_require__.e(\"vendors~BusinessList~BusinessNotifications~CustomerList~CustomerNotifications~GoodsList~Topup\"), __webpack_require__.e(\"GoodsList\")]).then(__webpack_require__.bind(null, /*! ./Other/GoodsList */ \"./src/page/Admin/Other/GoodsList.tsx\")),\r\n    loading: () => null\r\n});\r\nconst SetupForm = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => __webpack_require__.e(/*! import() | SetupForm */ \"SetupForm\").then(__webpack_require__.bind(null, /*! ./Other/SetupForm */ \"./src/page/Admin/Other/SetupForm.tsx\")),\r\n    loading: () => null\r\n});\r\nconst CustomerList = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => Promise.all(/*! import() | CustomerList */[__webpack_require__.e(\"vendors~BusinessList~BusinessNotifications~CustomerList~CustomerNotifications~GoodsList~Topup\"), __webpack_require__.e(\"CustomerList\")]).then(__webpack_require__.bind(null, /*! ./Customer/CustomerList */ \"./src/page/Admin/Customer/CustomerList.tsx\")),\r\n    loading: () => null\r\n});\r\nconst CustomerForm = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => __webpack_require__.e(/*! import() | CustomerForm */ \"CustomerForm\").then(__webpack_require__.bind(null, /*! ./Customer/CustomerForm */ \"./src/page/Admin/Customer/CustomerForm.tsx\")),\r\n    loading: () => null\r\n});\r\nconst BusinessList = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => Promise.all(/*! import() | BusinessList */[__webpack_require__.e(\"vendors~BusinessList~BusinessNotifications~CustomerList~CustomerNotifications~GoodsList~Topup\"), __webpack_require__.e(\"BusinessList\")]).then(__webpack_require__.bind(null, /*! ./Business/BusinessList */ \"./src/page/Admin/Business/BusinessList.tsx\")),\r\n    loading: () => null\r\n});\r\nconst BusinessForm = react_loadable__WEBPACK_IMPORTED_MODULE_1___default()({\r\n    loader: () => __webpack_require__.e(/*! import() | BusinessForm */ \"BusinessForm\").then(__webpack_require__.bind(null, /*! ./Business/BusinessForm */ \"./src/page/Admin/Business/BusinessForm.tsx\")),\r\n    loading: () => null\r\n});\r\nconst useStyles = Object(_material_ui_styles__WEBPACK_IMPORTED_MODULE_3__[\"makeStyles\"])((theme) => ({\r\n    content: {\r\n        flexGrow: 1,\r\n        backgroundColor: theme.palette.background.default,\r\n        padding: theme.spacing(3),\r\n        marginLeft: 240\r\n    },\r\n    contentChild: {\r\n        height: `calc(100vh - ${64 + 24 * 2}px)`,\r\n        maxWidth: 1200,\r\n        margin: \"auto\",\r\n        overflowX: \"auto\"\r\n    },\r\n    pieChartGrid: { minWidth: 600, position: \"relative\" },\r\n    pieChart: { height: 400, width: \"auto\" },\r\n    chartLabel: { position: \"absolute\", bottom: 16, width: \"100%\" }\r\n}));\r\nconst chartTheme = {\r\n    labels: {\r\n        text: {\r\n            fontSize: 16,\r\n            fontFamily: [\r\n                \"-apple-system\",\r\n                \"BlinkMacSystemFont\",\r\n                '\"Segoe UI\"',\r\n                \"Roboto\",\r\n                '\"Helvetica Neue\"',\r\n                \"Arial\",\r\n                \"sans-serif\",\r\n                '\"Apple Color Emoji\"',\r\n                '\"Segoe UI Emoji\"',\r\n                '\"Segoe UI Symbol\"'\r\n            ].join(\",\")\r\n        }\r\n    }\r\n};\r\nconst defs = [\r\n    {\r\n        id: \"total\",\r\n        type: \"patternDots\",\r\n        background: \"inherit\",\r\n        color: _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_7__[\"red\"][400],\r\n        size: 4,\r\n        padding: 1,\r\n        stagger: true\r\n    },\r\n    {\r\n        id: \"free\",\r\n        type: \"patternLines\",\r\n        background: \"inherit\",\r\n        color: _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_7__[\"green\"][400],\r\n        rotation: -45,\r\n        lineWidth: 6,\r\n        spacing: 7\r\n    }\r\n];\r\nfunction getFill(data) {\r\n    let variant = \"\";\r\n    switch (data.status) {\r\n        case \"total\":\r\n            variant = \"total\";\r\n            break;\r\n        case \"free\":\r\n            variant = \"free\";\r\n            break;\r\n        default:\r\n            variant = \"free\";\r\n    }\r\n    return {\r\n        match: {\r\n            id: data.id\r\n        },\r\n        id: variant\r\n    };\r\n}\r\nconst AdminGrid = ({ children }) => {\r\n    const classes = useStyles();\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"main\", { className: classes.content },\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { className: classes.contentChild }, children)));\r\n};\r\nconst ChartTooltip = ({ label, value }) => {\r\n    const theme = Object(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"useTheme\"])();\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { style: { display: \"flex\" } },\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { variant: \"body1\", style: {\r\n                color: theme.palette.grey[900],\r\n                fontWeight: 400,\r\n                marginRight: 16\r\n            } }, label),\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { variant: \"body1\", style: {\r\n                color: theme.palette.grey[900],\r\n                fontWeight: 700,\r\n                marginRight: 8\r\n            } }, value)));\r\n};\r\nconst DefaultComponent = () => {\r\n    const classes = useStyles();\r\n    const theme = Object(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"useTheme\"])();\r\n    const { csrf, setCsrf, _xhrPost, _thousandSeperater } = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_AppContext__WEBPACK_IMPORTED_MODULE_6__[\"AppContext\"]);\r\n    const [dashboard, setDashboard] = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useState\"])(null);\r\n    async function getDashboardData() {\r\n        const res = await _xhrPost({\r\n            csrf,\r\n            url: \"aloadusersystem\",\r\n            body: {\r\n                action: \"diskspace\"\r\n            }\r\n        });\r\n        console.log(res.data);\r\n        setCsrf(res.csrf);\r\n        setDashboard({\r\n            diskspace: {\r\n                data: res.data,\r\n                chart: [\r\n                    {\r\n                        id: \"พื้นที่เหลือใช้\",\r\n                        label: \"พื้นที่เหลือใช้\",\r\n                        value: res.data.free,\r\n                        status: \"free\"\r\n                    },\r\n                    {\r\n                        id: \"ใช้ไปแล้ว\",\r\n                        label: \"ใช้ไปแล้ว\",\r\n                        value: res.data.size - res.data.free,\r\n                        status: \"total\"\r\n                    }\r\n                ]\r\n            }\r\n        });\r\n    }\r\n    Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(() => {\r\n        getDashboardData();\r\n    }, []);\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", null, dashboard && (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, null,\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { className: classes.pieChartGrid },\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", { className: classes.pieChart },\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_nivo_pie__WEBPACK_IMPORTED_MODULE_2__[\"ResponsivePie\"], { data: dashboard.diskspace.chart, radialLabel: (d) => `${d.label} (${(d.value / 100).toFixed(2)} GB)`, sliceLabel: d => `${((d.value / dashboard.diskspace.data.size) * 100).toFixed(1)}%`, margin: { top: 40, right: 80, bottom: 80, left: 80 }, innerRadius: 0, padAngle: 0.7, cornerRadius: 3, borderWidth: 1, borderColor: { theme: \"grid.line.stroke\" }, radialLabelsSkipAngle: 9, radialLabelsTextXOffset: 6, radialLabelsTextColor: theme.palette.text.primary, radialLabelsLinkOffset: 0, radialLabelsLinkDiagonalLength: 16, radialLabelsLinkHorizontalLength: 24, radialLabelsLinkStrokeWidth: 1, radialLabelsLinkColor: theme.palette.text.primary, slicesLabelsTextColor: _material_ui_core_colors__WEBPACK_IMPORTED_MODULE_7__[\"grey\"][900], slicesLabelsSkipAngle: 12, animate: true, motionStiffness: 90, motionDamping: 15, defs: defs, fill: dashboard.diskspace.chart.map((d) => {\r\n                        return getFill(d);\r\n                    }), tooltip: d => {\r\n                        const val = d.value\r\n                            .toFixed(2)\r\n                            .toString()\r\n                            .split(\".\");\r\n                        return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(ChartTooltip, { label: d.label, value: `${_thousandSeperater(val[0])}.${val[1]}` }));\r\n                    }, theme: chartTheme })),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_material_ui_core__WEBPACK_IMPORTED_MODULE_4__[\"Typography\"], { variant: \"h6\", align: \"center\", className: classes.chartLabel }, \"\\u0E1E\\u0E37\\u0E49\\u0E19\\u0E17\\u0E35\\u0E48\\u0E08\\u0E31\\u0E14\\u0E40\\u0E01\\u0E47\\u0E1A\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\"))))));\r\n};\r\nconst Dashboard = ({ match, history, location }) => {\r\n    const { csrf, setCsrf, _xhrPost, sess } = Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_AppContext__WEBPACK_IMPORTED_MODULE_6__[\"AppContext\"]);\r\n    const passingProps = {\r\n        ...Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useContext\"])(_AppContext__WEBPACK_IMPORTED_MODULE_6__[\"AppContext\"]),\r\n        sess\r\n    };\r\n    async function getInfo() {\r\n        const res = await _xhrPost({\r\n            csrf,\r\n            url: \"aloadusersystem\",\r\n            body: {\r\n                action: \"info\"\r\n            }\r\n        });\r\n        console.log(res.data);\r\n        setCsrf(res.csrf);\r\n    }\r\n    Object(react__WEBPACK_IMPORTED_MODULE_0__[\"useEffect\"])(() => {\r\n        if (sess && sess.status === \"need login before\") {\r\n            history.replace(match.path);\r\n        }\r\n        getInfo();\r\n    }, []);\r\n    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_AppContext__WEBPACK_IMPORTED_MODULE_6__[\"AppContext\"].Provider, { value: passingProps },\r\n        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", null,\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(AdminHeader, null),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(AdminSideNav, null),\r\n            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(AdminGrid, null,\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { exact: true, path: match.path, component: DefaultComponent }),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { path: `${match.path}/topup`, component: Topup }),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { path: `${match.path}/goods_list`, component: GoodsList }),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { path: `${match.path}/setup`, component: SetupForm }),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { path: `${match.path}/customer_list`, component: CustomerList }),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { path: `${match.path}/customer_form`, component: CustomerForm }),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { path: `${match.path}/business_list`, component: BusinessList }),\r\n                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"Route\"], { path: `${match.path}/business_form`, component: BusinessForm })))));\r\n};\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(react_router_dom__WEBPACK_IMPORTED_MODULE_5__[\"withRouter\"])(props => react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Dashboard, Object.assign({}, props))));\r\n\n\n//# sourceURL=webpack:///./src/page/Admin/Dashboard.tsx?");

/***/ })

}]);