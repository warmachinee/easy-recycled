(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{624:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),s=a(26),o=a.n(s),i=a(22),r=a(40),c=a(104),u=a(31),d=a(103),p=a(165),m=a(143),b=a(151),f=a(39),y=a(37),E=a(397),g=a(299);const h=o()({loader:()=>Promise.all([a.e(2),a.e(16)]).then(a.bind(null,124)),loading:()=>null}),v=o()({loader:()=>Promise.all([a.e(78),a.e(61)]).then(a.bind(null,565)),loading:()=>null}),j=o()({loader:()=>Promise.all([a.e(76),a.e(45)]).then(a.bind(null,567)),loading:()=>null}),O=o()({loader:()=>Promise.all([a.e(0),a.e(1),a.e(3),a.e(4),a.e(46)]).then(a.bind(null,271)),loading:()=>null}),C=o()({loader:()=>a.e(30).then(a.bind(null,568)),loading:()=>null}),x=o()({loader:()=>Promise.all([a.e(79),a.e(66)]).then(a.bind(null,569)),loading:()=>null}),k=o()({loader:()=>Promise.all([a.e(0),a.e(37)]).then(a.bind(null,133)),loading:()=>null}),w=o()({loader:()=>Promise.all([a.e(0),a.e(6),a.e(25)]).then(a.bind(null,135)),loading:()=>null}),S=o()({loader:()=>a.e(64).then(a.bind(null,274)),loading:()=>null}),I=Object(i.f)(e=>l.a.createElement(v,Object.assign({},e))),P=Object(c.a)(e=>({paper:{padding:16,margin:"8px 16px",borderRadius:8}})),D=e=>{const t=P(),{csrf:a,setCsrf:s,profileData:o,_xhrPost:i,handleLogout:c,_thousandSeperater:b}=Object(n.useContext)(u.a),{userInfo:y,booleanDispatch:v}=e;return l.a.createElement(d.a,{elevation:3,className:t.paper},l.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},l.a.createElement(p.a,{variant:"h6",style:{marginRight:16}},"เงินคงเหลือ"),l.a.createElement("div",{style:{width:16}}),l.a.createElement(p.a,{variant:"h6",style:{marginRight:8,fontWeight:700}},y&&y.info&&"number"==typeof y.info.balance?`${b(y.info.balance)}`:"-"),l.a.createElement(E.a,null)),l.a.createElement(m.a,{style:{marginTop:12}}),l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},l.a.createElement(h,{startIcon:l.a.createElement(g.a,null),variant:"text",buttonColor:f.a,onClick:()=>v({type:"true",key:"addTopup"})},"เติมเงิน"),l.a.createElement(r.b,{to:"/#topup_list",style:{textDecoration:"none",color:"inherit"}},l.a.createElement(h,{variant:"text",buttonColor:f.a},"ประวัติการเติมเงิน"))))},T=({value:e,topup:t,setTopup:a})=>l.a.createElement(h,Object.assign({style:{flex:1},variant:"contained"},t===e&&{buttonColor:y.a},{onClick:()=>a(e)}),e),_=e=>{const{topupEtc:t,topup:a,setTopup:n,setTopupEtc:s,onCreate:o,slip:i,setSlip:r,bankDetail:c}=e;return l.a.createElement("div",null,c&&l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a,{variant:"h6"},"รายละเอียด"),l.a.createElement(p.a,{style:{whiteSpace:"pre-line"}},c.topup)),l.a.createElement(m.a,{style:{margin:"16px 0"}}),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:50},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:100},e))),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:150},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:200},e))),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:300},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:500},e))),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:1e3},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:"เลือกจำนวนเงิน"},e))),"เลือกจำนวนเงิน"===a&&l.a.createElement(b.a,{fullWidth:!0,value:`${t}`,variant:"outlined",size:"small",type:"number",label:"จำนวนเงิน",onChange:e=>s(parseInt(e.target.value))}),l.a.createElement(m.a,{style:{margin:"16px 0"}}),l.a.createElement("div",{style:{display:"flex"}},l.a.createElement(S,Object.assign({fullWidth:!0,label:"อัพโหลดสลิป"},{slip:i,setSlip:r})),i&&l.a.createElement(h,{onClick:()=>r(null)},"รีเซ็ต")),i&&l.a.createElement(p.a,{variant:"caption"},i.name),l.a.createElement(m.a,{style:{margin:"24px 0"}}),l.a.createElement(h,{style:{width:"100%"},variant:"contained",buttonColor:f.a,onClick:()=>o({action:"delete"}),disabled:null===i},"เติมเงิน"))},L=({history:e,location:t})=>{P();const{csrf:a,setCsrf:s,profileData:o,_xhrPost:i,_fetchFile:r,handleLogout:c,booleanReducer:d,useConfirmDeleteItem:m,checkSession:b,_onLocalhost:y,realtimeAccess:g,addSnackbar:v,userInfo:S,setUserInfo:T}=Object(n.useContext)(u.a),[{addTopup:L,topupList:B,noti:R,userProfile:W},z]=Object(n.useReducer)(d,{forgot:!1,topupList:"#topup_list"===t.hash,noti:!1,userProfile:!1}),[$,q]=Object(n.useState)(50),[A,F]=Object(n.useState)(0),[J,N]=Object(n.useState)(null),[U,G]=Object(n.useState)(null),[{confirmState:H,item:K},M]=m();async function Q(){const e=await i({csrf:a,url:"loadusersystem",body:{action:"info",linetoken:o.userId,type:"customer"}});s(e.csrf),"status"in e.data&&"this is not user account or have been delete account"===e.data.status?b():(T(e.data),async function(){const e=await i({csrf:a,url:"loadusersystem",body:{action:"howtotopup",linetoken:o.userId,type:"customer"}});s(e.csrf),G(e.data)}())}return Object(n.useEffect)(()=>{o&&Q()},[]),Object(n.useEffect)(()=>{z({type:`${"#topup_list"===t.hash}`,key:"topupList"})},[t]),l.a.createElement("div",null,l.a.createElement(C,Object.assign({},{userInfo:S,handleLogout:c,booleanDispatch:z})),l.a.createElement(D,Object.assign({},{userInfo:S,booleanDispatch:z})),l.a.createElement(h,{buttonColor:f.a,variant:"contained",size:"large",style:{margin:16,width:"calc(100% - 32px)",fontSize:24,letterSpacing:4,padding:24},onClick:()=>e.replace("/market")},"บอร์ดสินค้า"),l.a.createElement(j,null),l.a.createElement(w,{type:"delete",open:H,onClose:()=>M({action:"cancel"}),onCancel:()=>M({action:"cancel"}),onSubmit:async function(){const e={action:"createtopup",linetoken:o.userId,type:"customer",value:"เลือกจำนวนเงิน"===$?parseInt(A):$},t=await i({csrf:a,url:"usersystem",body:e});if(s(t.csrf),g(),"success"===t.data.status){v({message:"เพิ่มเงินสำเร็จ",variant:"success"});const e=await r({url:"usersystem",csrf:a,headers:{action:"receipt",type:"customer",requestid:t.data.requestid},body:{receiptimage:J}});s(e.csrf),"success"===e.data.status?(v({message:"อัพโหลดสลิปสำเร็จ",variant:"success"}),N(null),q(50),F(0),Q(),z({type:"falseAll"}),M({action:"cancel"})):v({message:"อัพโหลดสลิปไม่สำเร็จ",variant:"success"})}else v({message:"เพิ่มเงินไม่สำเร็จ",variant:"error"})},title:"คุณแน่ใจหรือไม่ว่าต้องการจะเติมเงิน ?",headIcon:E.a,headIconColor:f.a,submitButtonColor:f.a,submitText:"เติมเงิน"},l.a.createElement(p.a,{variant:"h6",style:{fontWeight:400},align:"center"},K&&K.business_name)),l.a.createElement(k,{open:B,onClose:()=>e.replace("/"),title:"ประวัติการเติมเงิน",fullScreen:!0,dividers:!1,contentStyle:{padding:0}},l.a.createElement(I,Object.assign({},{userInfo:S,booleanDispatch:z}))),l.a.createElement(k,{open:L,onClose:()=>z({type:"false",key:"addTopup"}),title:"เลือกจำนวนเงิน"},l.a.createElement(_,Object.assign({},{topup:$,setTopup:q,topupEtc:A,setTopupEtc:F,onCreate:M,slip:J,setSlip:N,bankDetail:U}))),l.a.createElement(k,{open:R,onClose:()=>z({type:"false",key:"noti"}),title:"การแจ้งเตือน",fullScreen:!0,dividers:!1,contentStyle:{padding:0}},l.a.createElement(O,{type:"customer"})),l.a.createElement(k,{open:W,fullScreen:!0,onClose:()=>z({type:"false",key:"userProfile"}),title:"โปรไฟล์"},l.a.createElement(x,Object.assign({},{userInfo:S,booleanDispatch:z,getInfo:Q}))))};t.default=Object(i.f)(e=>l.a.createElement(L,Object.assign({},e)))}}]);