(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{631:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),s=a(26),i=a.n(s),o=a(22),r=a(40),c=a(104),u=a(28),p=a(103),d=a(176),m=a(151),b=a(149),f=a(39),y=a(37),g=a(419),E=a(328);const h=i()({loader:()=>Promise.all([a.e(1),a.e(16)]).then(a.bind(null,124)),loading:()=>null}),v=i()({loader:()=>Promise.all([a.e(79),a.e(61)]).then(a.bind(null,572)),loading:()=>null}),j=i()({loader:()=>Promise.all([a.e(77),a.e(45)]).then(a.bind(null,574)),loading:()=>null}),O=i()({loader:()=>Promise.all([a.e(0),a.e(2),a.e(3),a.e(4),a.e(46)]).then(a.bind(null,300)),loading:()=>null}),C=i()({loader:()=>Promise.all([a.e(75),a.e(30)]).then(a.bind(null,575)),loading:()=>null}),x=i()({loader:()=>Promise.all([a.e(80),a.e(66)]).then(a.bind(null,577)),loading:()=>null}),k=i()({loader:()=>Promise.all([a.e(0),a.e(37)]).then(a.bind(null,134)),loading:()=>null}),w=i()({loader:()=>Promise.all([a.e(0),a.e(25)]).then(a.bind(null,131)),loading:()=>null}),S=i()({loader:()=>a.e(64).then(a.bind(null,302)),loading:()=>null}),I=Object(o.f)(e=>l.a.createElement(v,Object.assign({},e))),P=Object(c.a)(e=>({paper:{padding:16,margin:"8px 16px",borderRadius:8}})),D=e=>{const t=P(),{csrf:a,setCsrf:s,profileData:i,_xhrPost:o,handleLogout:c,_thousandSeperater:b}=Object(n.useContext)(u.a),{userInfo:y,booleanDispatch:v}=e;return l.a.createElement(p.a,{elevation:3,className:t.paper},l.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},l.a.createElement(d.a,{variant:"h6",style:{marginRight:16}},"เงินคงเหลือ"),l.a.createElement("div",{style:{width:16}}),l.a.createElement(d.a,{variant:"h6",style:{marginRight:8,fontWeight:700}},y&&y.info&&"number"==typeof y.info.balance?`${b(y.info.balance)}`:"-"),l.a.createElement(g.a,null)),l.a.createElement(m.a,{style:{marginTop:12}}),l.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},l.a.createElement(h,{startIcon:l.a.createElement(E.a,null),variant:"text",buttonColor:f.a,onClick:()=>v({type:"true",key:"addTopup"})},"เติมเงิน"),l.a.createElement(r.b,{to:"/#topup_list",style:{textDecoration:"none",color:"inherit"}},l.a.createElement(h,{variant:"text",buttonColor:f.a},"ประวัติการเติมเงิน"))))},T=({value:e,topup:t,setTopup:a})=>l.a.createElement(h,Object.assign({style:{flex:1},variant:"contained"},t===e&&{buttonColor:y.a},{onClick:()=>a(e)}),e),_=e=>{const{topupEtc:t,topup:a,setTopup:n,setTopupEtc:s,onCreate:i,slip:o,setSlip:r,bankDetail:c}=e;return l.a.createElement("div",null,c&&l.a.createElement(l.a.Fragment,null,l.a.createElement(d.a,{variant:"h6"},"รายละเอียด"),l.a.createElement(d.a,{style:{whiteSpace:"pre-line"}},c.topup)),l.a.createElement(m.a,{style:{margin:"16px 0"}}),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:50},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:100},e))),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:150},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:200},e))),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:300},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:500},e))),l.a.createElement("div",{style:{display:"flex",marginBottom:16}},l.a.createElement(T,Object.assign({value:1e3},e)),l.a.createElement("div",{style:{width:16}}),l.a.createElement(T,Object.assign({value:"เลือกจำนวนเงิน"},e))),"เลือกจำนวนเงิน"===a&&l.a.createElement(b.a,{fullWidth:!0,value:`${t}`,variant:"outlined",size:"small",type:"number",label:"จำนวนเงิน",onChange:e=>s(parseInt(e.target.value))}),l.a.createElement(m.a,{style:{margin:"16px 0"}}),l.a.createElement("div",{style:{display:"flex"}},l.a.createElement(S,Object.assign({fullWidth:!0,label:"อัพโหลดสลิป"},{slip:o,setSlip:r})),o&&l.a.createElement(h,{onClick:()=>r(null)},"รีเซ็ต")),o&&l.a.createElement(d.a,{variant:"caption"},o.name),l.a.createElement(m.a,{style:{margin:"24px 0"}}),l.a.createElement(h,{style:{width:"100%"},variant:"contained",buttonColor:f.a,onClick:()=>i({action:"delete"}),disabled:null===o},"เติมเงิน"))},L=({history:e,location:t})=>{P();const{csrf:a,setCsrf:s,profileData:i,_xhrPost:o,_fetchFile:r,handleLogout:c,booleanReducer:p,useConfirmDeleteItem:m,checkSession:b,_onLocalhost:y,realtimeAccess:E,addSnackbar:v,userInfo:S,setUserInfo:T,liffLogin:L}=Object(n.useContext)(u.a),[{addTopup:B,topupList:R,noti:N,userProfile:U},W]=Object(n.useReducer)(p,{forgot:!1,topupList:"#topup_list"===t.hash,noti:!1,userProfile:!1}),[z,$]=Object(n.useState)(50),[q,A]=Object(n.useState)(0),[F,J]=Object(n.useState)(null),[G,H]=Object(n.useState)(null),[{confirmState:K,item:M},Q]=m();async function V(){const e=await o({csrf:a,url:"loadusersystem",body:{action:"info",linetoken:i.userId,type:"customer"}});if(s(e.csrf),"status"in e.data&&"this is not user account or have been delete account"===e.data.status)b();else{const t=e.data,n=t.info;n.displayname!==i.displayName||n.picture!==i.pictureUrl?async function(e){const t={action:"editprofile",linetoken:i.userId,type:"customer"};e.displayname!==i.displayName&&Object.assign(t,{displayname:i.displayName});e.picture!==i.pictureUrl&&Object.assign(t,{picture:i.pictureUrl});const n=await o({csrf:a,url:"usersystem",body:t});s(n.csrf),L()}(n):(T(t),async function(){const e=await o({csrf:a,url:"loadusersystem",body:{action:"howtotopup",linetoken:i.userId,type:"customer"}});s(e.csrf),H(e.data)}())}}return Object(n.useEffect)(()=>{i&&V()},[]),Object(n.useEffect)(()=>{W({type:`${"#topup_list"===t.hash}`,key:"topupList"})},[t]),l.a.createElement("div",null,l.a.createElement(C,Object.assign({},{userInfo:S,handleLogout:c,booleanDispatch:W})),l.a.createElement(D,Object.assign({},{userInfo:S,booleanDispatch:W})),l.a.createElement(h,{buttonColor:f.a,variant:"contained",size:"large",style:{margin:16,width:"calc(100% - 32px)",fontSize:24,letterSpacing:4,padding:24},onClick:()=>e.replace("/market")},"บอร์ดสินค้า"),l.a.createElement(j,null),l.a.createElement(w,{type:"delete",open:K,onClose:()=>Q({action:"cancel"}),onCancel:()=>Q({action:"cancel"}),onSubmit:async function(){const e={action:"createtopup",linetoken:i.userId,type:"customer",value:"เลือกจำนวนเงิน"===z?parseInt(q):z},t=await o({csrf:a,url:"usersystem",body:e});if(s(t.csrf),E(),"success"===t.data.status){v({message:"เพิ่มเงินสำเร็จ",variant:"success"});const e=await r({url:"usersystem",csrf:a,headers:{action:"receipt",type:"customer",requestid:t.data.requestid},body:{receiptimage:F}});s(e.csrf),"success"===e.data.status?(v({message:"อัพโหลดสลิปสำเร็จ",variant:"success"}),J(null),$(50),A(0),V(),W({type:"falseAll"}),Q({action:"cancel"})):v({message:"อัพโหลดสลิปไม่สำเร็จ",variant:"success"})}else v({message:"เพิ่มเงินไม่สำเร็จ",variant:"error"})},title:"คุณแน่ใจหรือไม่ว่าต้องการจะเติมเงิน ?",headIcon:g.a,headIconColor:f.a,submitButtonColor:f.a,submitText:"เติมเงิน"},l.a.createElement(d.a,{variant:"h6",style:{fontWeight:400},align:"center"},M&&M.business_name)),l.a.createElement(k,{open:R,onClose:()=>e.replace("/"),title:"ประวัติการเติมเงิน",fullScreen:!0,dividers:!1,contentStyle:{padding:0}},l.a.createElement(I,Object.assign({},{userInfo:S,booleanDispatch:W}))),l.a.createElement(k,{open:B,onClose:()=>W({type:"false",key:"addTopup"}),title:"เลือกจำนวนเงิน"},l.a.createElement(_,Object.assign({},{topup:z,setTopup:$,topupEtc:q,setTopupEtc:A,onCreate:Q,slip:F,setSlip:J,bankDetail:G}))),l.a.createElement(k,{open:N,onClose:()=>W({type:"false",key:"noti"}),title:"การแจ้งเตือน",fullScreen:!0,dividers:!1,contentStyle:{padding:0}},l.a.createElement(O,{type:"customer"})),l.a.createElement(k,{open:U,fullScreen:!0,onClose:()=>W({type:"false",key:"userProfile"}),title:"โปรไฟล์"},l.a.createElement(x,Object.assign({},{userInfo:S,booleanDispatch:W,getInfo:V}))))};t.default=Object(o.f)(e=>l.a.createElement(L,Object.assign({},e)))}}]);